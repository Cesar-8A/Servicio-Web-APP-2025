{% extends "home.html" %}

{% block content %}
<div class="container mt-4 text-center">
    {% if success == 0 %}
        <h1 class="text-warning">Carga primero una imagen</h1>
    {% else %}
        <div class="card bg-black text-light shadow-lg p-4 border-0 rounded-3 border border-warning">
            <h1 class="mb-3 text-warning">Visualización DICOM</h1>
            <p class="lead text-light">Renderizado de la imagen cargada.</p>

            <!-- Contenedor del visor con mejor presentación -->
            <div class="d-flex justify-content-center">
                <div class="border border-secondary rounded-3 shadow-lg p-3 bg-dark">
                    <iframe src="http://127.0.0.1:5010/panel" id="DicomRender" width="400" height="500"
                        class="border-0 rounded-3 shadow-sm">
                    </iframe>
                </div>
            </div>

            <!-- Subir RT Struct (NRRD) -->
            <div class="mt-4">
                <h2 class="text-warning">Subir RT Struct (NRRD)</h2>
                <form action="/upload_RT" method="post" enctype="multipart/form-data" class="mt-3">
                    <div class="input-group w-50 mx-auto">
                        <input type="file" name="file" accept=".nrrd" class="form-control bg-secondary text-light border-0 shadow-sm">
                        <button type="submit" class="btn" style="background-color: #B10202; color: white;">
                            <i class="bi bi-upload"></i> Subir
                        </button>
                    </div>
                </form>
            </div>
        </div>
    {% endif %}
</div>

<script>
    document.querySelector("form").addEventListener("submit", function(event) {
        event.preventDefault();  
        let formData = new FormData(this);

        fetch("/upload_RT", {
            method: "POST",
            body: formData
        });

        alert("Archivo cargado correctamente.");
    });
</script>
{% endblock %}
